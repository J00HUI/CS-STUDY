### 3. 프레임 릴레이와 셀 릴레이
* 패킷 교환 방식이 개발된 시점에는 원거리 디지털 통신 과정에서 지금보다 더 많은 전송 오류가 발생했다.
* 그래서 전송 패킷에 물리적인 전송 오류를 처리하기 위한 오버헤드 비트를 많이 추가했는데, 이런 패킷들을 처리하는 송수신 시스템의 오류 처리 과정이 상당히 복잡했다.
* 또한 중간에 위치한 교환 시스템에서 오류를 검색하고 복구하는 기능도 필요했다.
* 이와 달리, 현대의 네트워크는 물리적인 전송 오류가 발생할 확률이 매우 낮다.
* 과거의 과도한 오류 제어 기능이 현재의 통신 환경에서는 낭비 요소가 된 것이다.
* 여러 계층에서 수행되는 복잡한 오류 제어 기능 중, 중복되는 부분을 제거하면 패킷의 전송 속도를 높일 수 있다.
* 이처럼, 낭비 요소를 제거해 데이터 전송 속도를 향상시키기 위해 프레임 릴레이와 셀 릴레이 방식이 고안되었다.
</br>

### 3.1 프레임 릴레이
* 신뢰도가 높은 새로운 네트워크 환경을 고려해, 전송 오류 제어 기능을 더 효율적으로 처리하는 네트워크 프로토콜을 작성할 필요가 있다.
* 이를 위해, 동일한 속도의 전송 매체로, 고속 데이터 전송을 지원할 수 있도록 고안된 기술이 **프레임 릴레이** (Frame Relay)이다.

그림은 송신 호스트가 데이터 패킷을 보내고, 수신 호스트가 긍정 응답 패킷으로 회신하는 과정을 패킷 교환 방식과 프레임 릴레이 방식에 각각 적용한 예이다.   

<그림 p.91>

* (a)의 패킷 교환 방식에서는 중간 라우터를 거치는 과정에서, 데이터 링크 계층의 기능이 개별적으로 수행된다.
* 따라서 개별 링크에서 데이터 프레임과 긍정 응답 프레임을 반복 교환한다.
* (b)의 프레임 릴레이 방식보다 오류 제어가 과도하게 이루어진다.
</br>

* (b)의 프레임 릴레이 방식에서는 각 라우터의 개별 연결을 의미하는 홉(Hop) 단위의 흐름 제어와 오류 제어 기능을 수행하지 않는다.
* 따라서 데이터 전송과 긍정 응답의 처리가 큰 흐름으로 이루어져, 전송 패킷의 양이 반으로 줄어든다.
* 이처럼 오류 제어 기능을 단순화하는 작업만으로도 데이터 전송 효율을 크게 향상시킬 수 있다.
</br>

* 패킷 교환 방식이 종단 사용자에게 64Kbps의 전송률을 지원하는 데 반해, 프레임 릴레이 방식은 2Mbps 전송률을 지원한다.
* 이는 앞서 언급한 오류 처리와 관련된 오버헤드를 최소화하여 얻은 결과이다.
* 참고로, 프레임 릴레이 방식은 연결형 패킷 서비스를 지원한다.
* 프레임 릴레이는 한 호스트에서 수신한 프레임을 다른 호스트로 중개(Relay)하는 역할만 한다.
* 오류 복구나 흐름 제어 같은 기능은 수행하지 않으므로, 데이터 링크 계층의 기능을 단순하게 설계할 수 있다.
</br>

### 3.2 셀 릴레이
* ATM(Asynchronous Transfer Mode) 방식응로 더 많이 알려진 셀 릴레이(Cell Relay) 방식은 회선 교환과 패킷 교환 방식이 장점을 모아 고안되었다.
* 셀 릴레이 방식도 프레임 릴레이 방식처럼 오류 제어에 대한 오버헤드를 최소화한다.
* 프레임 릴레이 방식은 가변 길이의 패킷을 지원하지만, 셀 릴레이 방식은 셀(Cell)이라는 고정 크기의 패킷을 사용한다.
* 패킷이 크기가 고정되면, 가변적인 경우보다 처리 과정에서 오버헤드를 더 줄일 수 있다.
* 셀 릴레이 방식은 2~100Mbps의 전송률을 지원한다.
</br>

### 💎 02 LAN, MAN, LAN
컴퓨터 네트워크를 다양한 기준으로 분류할 수 있지만, 가장 간단한 기준은 네트워크의 크기이다.   
```
가장 작은 네트워크의 구성 예는 컴퓨터 시스템 내부에서 볼 수 있다.
매우 빠른 전송 속도를 지원하는 시스템 버스를 이용해 다수의 프로세서(Processor)를 연결하는 다중 처리 시스템(Multiprocessor system)이 이에 해당한다.
```
</br>

컴퓨터 시스템의 내부와 컴퓨터 네트워크의 차이는 전송 매체의 성능에 있다.
* 시스템 버스는 매우 빠른 속도와 높은 전송 대역을 지원하기 때문에, 버스에 연결되는 CPU, 메모리, I/O 장치 등이 낮은 전송 지연으로 데이터를 전송할 수 있는 밀접한 연결(Tightly Coupled) 관계를 갖는다.
* 그에 비해, 네트워크는 전송 매체의 속도가 상대적으로 느려 느슨한 연결(Loosely Coupled) 관계를 지원한다.
</br>

* 일반적으로 네트워크는 물리적으로 일정 거리 이상 떨어진 위치에서 독립적으로 실행할 수 있는 호스트 간의 데이터 교환 환경을 지원한다.
* 호스트 사이의 연결 거리를 기준으로, 네트워크를 LAN, MAN, WAN 으로 구분할 수 있다.
* 이 연결 거리는 데이터의 전송 지연에 많은 영향을 미치므로 네트워크를 설계할 때 중요한 고려 사항이 된다.
</br>

![image](https://user-images.githubusercontent.com/83942393/128685157-83c749a4-7025-42e0-b691-9a5ec882b481.png)


### 1. LAN
LAN(Local Area Network)는 단일 건물이나 학교 같은 소규모 지역에 위치하는 호스트로 구성된 네트워크이다.   
규모가 아주 작을 때는 단일 전송 케이블로 모든 호스트를 연결할 수 있다.   
LAN 은 MAN 이나 WAN 환경보다 호스트 간의 간격이 가깝기 때문에, 데이터를 **브로드 캐스팅** (Broadcasting) 방식으로 전송한다.   

* 호스트 사이의 물리적 거리는 데이터 전송 과정에 영향을 많이 미친다.   
* 가까울수록 데이터 전송 지연이 적으며, 전송 오류가 발생할 가능성도 낮아진다.   
* LAN 에서는 보통 수십 Mbps~ 수Gbps 전송 속도를 지원한다.   
* LAN 환경에서 호스트를 연결하는 방식을 구성 형태(Topology)에 따라 **버스형, 링형** 으로 구분한다.   
</br>

### 1.1 버스형
LAN 환경에서 가장 많이 사용하는 네트워크 연결 형태는 버스형과 링형이다.    

* 버스(Bus)형은 그림처럼 공유 버스 하나에 여러 호스트를 직접 연결한다.
* 한 호스트가 전송한 데이터를 네트워크에 연결된 모든 호스트에 전송하므로, 브로드캐스팅 방식이다.

![image](https://user-images.githubusercontent.com/83942393/128682516-4d6cfc26-5039-4dde-b68a-82f09dda6212.png)

* 버스형 에서는 전송 데이터가 모든 호스트에 전송되므로, 라우팅 기능이 따로 필요 없다.
* 목적지에 해당하는 호스트만 데이터를 내부 버퍼에 보관하고 나머지 호스트들은 데이터를 버림으로써 한 호스트만 데이터를 수신한다.
* 이를 위해 각 호스트를 구분하는 호스트 주소를 이용하고, 전송 데이터에는 송수신 호스트의 주소를 표기한다.
* 둘 이상의 호스트에서 데이터를 동시에 전송하려고 하면, 공유 버스에서 데이터 **충돌** (collision)이 발생할 수 있다.
```
충돌 문제를 해결하는 방법에는
충돌이 발생할 가능성 자체를 차단하는 사전 해결 방식과
충돌을 허용하고, 나중에 해결하는 사후 해결 방식이 있다.
```
* 대표적인 버스형 연결 형태인 이더넷(Ethernet)은 충돌이 발생하는 것을 허용하는 대신, 충돌 후에 문제를 해결하는 사후 해결 방식이다.
* 이더넷 방식은 원래 1~10Mbps의 전송 속도를 지원했지만, 100Mbps, 1Gbps의 고속 이더넷이 등장하면서 영상 데이터처럼 높은 전송률이 필요한 응용 환경에서도 사용할 수 있게 되었다.
</br>

### 1.2 링형
* 링(Ring) 형은 그림처럼 전송 호스트의 연결이 순환 구조인 링 형태이다.
* 데이터는 시계나 반시계 방향으로 전송되며, 특정 호스트에서 전송한 데이터는 반드시 링을 한 바퀴 돌아 송신 호스트로 되돌아온다.
* 따라서 네트워크에 연결된 모든 호스트가 전송 데이터를 수신하는 브로드캐스팅 방식을 지원한다.
* 데이터를 송신한 호스트는 자신에게 되돌아온 데이터를 네트워크에서 회수할 책임이 있다.
</br>

* 링형도 둘 일상의 호스트에서 데이터를 동시에 전송하면, 충돌이 발생할 수 있다.
* 일반적으로 링형에서는 토큰(Token)이라는 제어 프레임을 사용해 충돌 가능성을 차단한다.
* 데이터를 전송할 호스트는 사전에 전송용 토큰을 확보해야 한다.
* 네트워크에는 토큰이 하나만 존재하도록 설계되므로, 특정 시간에 데이터를 전송할 수 있는 호스트는 하나뿐이다.
* 따라서, 호스트 사이에 충돌이 발생할 가능성을 미리 차단할 수 있다.
* 토큰은 네트워크에 연결된 호스트를 모두 순환하도록 설계되었기 때문에, 모든 호스트가 동등한 전송 기회를 갖는다.
</br>

### 2. MAN
* MAN(Metropolitan Area Network)은 LAN 보다 큰 지역을 지원한다.
* 사용하는 하드웨어와 소프트웨어는 LAN과 비슷하지만, 연결 규모가 더 크다.
* MAN은 근처에 위치한 여러 건물이나 한 도시에서의 네트워크 연결로 구성할 수 있다.
</br>

* MAN을 위한 국제 표준안은 DQDB(Distributed Queue Dual Bus)이다.
* 전송 방향이 다른 두 버스로 모든 호스트를 연결하는 구조를 지원한다.
</br>

* DQDB는 비디오와 그래픽 응용 환경을 위한 광 LAN을 위해 개발되었지만, DQDB 구조가 MAN 환경에 적합하여 MAN의 표준안으로 채택되었다.
* 그 후 케이블 TV 산업에 의해 개발이 촉진되었다.
</br>

* DQDB의 특징은 세 가지로 요약할 수 있다.
* 첫째, 분산 데이터 큐를 유지한다.
* 둘째, 데이터를 전송할 때 발생할 수 있는 충돌 문제를 해결하기 위해, 슬롯 링 개념을 변형한 FIFO 기반의 공유 슬롯 방식을 사용한다.
* 마지막으로, ATM(Asynchronous Transfer Mode)과 호환이 가능하도록 53바이트의 프레임을 지원한다.
</br>

DQDB에는 그림의 화솰표처럼 두 개의 단방향 선로가 존재하며, 이 전송 선로를 통해 모든 호스트가 연결된다.   

<img width="596" alt="스크린샷 2021-08-09 오후 6 28 52" src="https://user-images.githubusercontent.com/83942393/128685877-df539119-89d4-448d-aa08-f9682bba20e2.png">

* 버스 1은 데이터를 왼쪽에서 오른쪽으로, 버스 2는 오른쪽에서 왼쪽으로 전송한다.
* 버스 1에서는 헤드 역할을 하는 a가 일정 주기로 슬롯(Slot)을 내보내고, 이 슬롯은 호스트 e 에서 처리를 완료할 때까지 오른쪽으로 계속 이동한다.
* 이 과정에서 중간 호스트는 슬롯을 프레임으로 변형해 데이터를 전송할 수 있다.
* 버스 2에도 같은 원리가 적용되며, 데이터를 반대 방향으로 전송할 때 이용한다.
* 호스트 a에서 호스트 e까지 물리적인 거리가 짧으면 그림의 점선처럼 새로운 연결을 구성할 수 있다.
* 즉, 호스트 a와 호스트 e를 직접 연결하는 추가 전송 매체를 사용함으로써, 신뢰도를 높일 수 있다.
</br>

### 3. WAN
* WAN(Wide Area Network)은 국가 이상의 넓은 지역을 지원하는 네트워크 구조이다.
* LAN과 MAN의 구성엣서는 전송 호스트가 공유 버스를 이용한 브로드캐스팅을 지원하기 때문에 교환의 개념이 필요 없다.
* 그러나 **점대점** (Point-to-Point)으로 연결된 WAN 환경에서는 전송과 더불어 교환 기능이 필요하다.
</br>

WAN에서는 그림처럼 전송 매체를 이용해 호스트를 일대일(1:1)로 연결하는 방식으로 네트워크를 확장한다.    
</br>

![image](https://user-images.githubusercontent.com/83942393/128687241-48718e5c-b97e-4b4f-bed8-039529927d88.png)
</br>

* WAN 에서는 호스트 사이의 거리가 멀기 때문에 연결의 수가 증가할수록 전송 매체를 많이 사용하므로 비용이 많이 든다.
* 따라서 총 연결 거리를 줄이면서 전체 호스트를 효율적으로 연결하도록 설계해야 한다.
* WAN에서는 호스트를 스타형, 트리형, 완전형, 불규칙형 등 다양한 구조로 연결할 수 있다.
</br>

### 💎 03 인터네트워킹
라우팅 장비는 네트워크 내부에서 패킷 교환 기능을 수행하는데, 둘 이상의 서로 다른 네트워크를 연결하는 기능을 인터네트워킹(Internetworking)이라 한다.   
인터네트워킹을 지원하려면 연결되는 네트워크의 차이를 분석해, 전송 데이터를 적절히 중개할 수 있어야 한다.   

두 개의 네트워크를 연결하는 장비는 역할이 어느 계층에 속하느냐에 따라 종류가 달라진다.   
일반적으로 하위 3개 계층인 물리 계층, 데이터 링크 계층, 네트워크 계층의 기능을 수행하며, 특별히 네트워크 계층까지의 기능을 수행하는 장비는 라우터(Router)이다.   

네트워크 간의 차이는 다양한 방법으로 기술할 수 있다.   
```
예를 들어, 연결형·비연결형 서비스, 데이터 전송에 사용되는 프로토콜의 종류, 호스트를 구분하기 위한 주소 표현 방법, 전송 패킷의 크기, 멀티 캐스팅·브로드캐스팅의 지원 여부 등이 고려 대상이다.   
```
</br>

그림은 네트워크 연결을 위한 게이트웨이(Gateway) 장비의 역할을 보여준다.   

<img src="https://user-images.githubusercontent.com/83942393/128690265-a8cdf1c3-b536-4019-9804-a430bbaadf60.png" width="50%" height="50%"></img></br>

* 그림처럼 두 LAN을 연결하려면, 중간에 있는 네트워크 장비가 데이터를 중개해야 한다.   
* 네트워크 장비의 기능에 따라(네트워크 장비의 네트워크 계층, 데이터 링크 계층, 물리 계층의 기능에 따라) 양쪽 LAN 은 특성이 다를 수 있으며, 네트워크 장비 하나에 여러 종류의 LAN을 연결할 수도 있다.   
* 네트워크 장비는 수행 기능에 따라 리피터, 브리지, 라우터로 구분한다.   
```
참고로 데이터 링크 계층은 MAC 계층과 LLC 계층으로 나뉘며, MAC 계층이 하위에 위치하고 LLC 계층은 상위에 위치한다. (이에 대한 자세한 내용은 5장에서 다룬다. )
```
</br>

> 리피터
* 리피터는 계층 1 기능을 지원한다.
* 한쪽 단에서 들어온 비트 신호를 증폭하여 다른 단으로 단순히 전달하는 역할을 한다.
</br>

> 브리지
* 브리지는 계층 2 기능을 지원한다.
* 한쪽 단에서 들어온 프레임의 MAC 계층 헤더를 다른 단의 MAC 계층 헤더로 변형해 전송할 수 있어 종류가 다른 LAN을 연결할 수 있다.
* 브리지가 수신한 프레임의 목적지 주소와 송신 호스트의 주소가 같은 LAN에 소속되어 있으면 브리지는 아무 행동도 하지 않는다.
* 그러나 송수신 호스트의 위치가 서로 다른 LAN 에 속하면 중개 기능을 수행한다.
* 따라서 브리지는 리피터보다 LAN과 LAN 사이의 불필요한 트래픽 발생을 억제할 수 있다.
</br>

> 라우터
* 라우터는 계층 3 기능을 지원한다.
* 교환 기능을 수행할 수 있으므로, 여러 포트를 사용해 다수의 LAN을 연결하는 구조를 지원한다.
* 수신한 패킷을 해석해 적절한 경로로 전송하도록 경로를 배정하는 기능을 한다.
</br>

> 일반적으로 상위 계층의 개념인 게이트웨이는 서로 다른 응용 환경을 지원하기 위해 사용할 수 있으므로, 네트워크 양단의 특성이 다른 환경에서 중개하는 역할을 수행한다.   
</br>

### 1. 브리지
* 브리지 좌우에 위치하는 LAN은 종류가 같을 수도 있고, 다를 수도 있다.
* 에를 들어, 양쪽 LAN이 모두 이더넷을 사용하면, 프레임 헤더를 해석하는 간단한 작업을 통해 쉽게 중개할 수 있다.
* 하지만 종류가 다르면 프레임 변환 등의 복잡한 과정이 필요하다.

그림은 계층 2 의 기능을 수행하는 일반 브리지의 역할을 보여준다.   

<img src="https://user-images.githubusercontent.com/83942393/128692412-b8d882f7-c746-4517-8713-bd855ea87808.png" width="60%" height="60%"></img></br>

* 브리지를 이용해 LAN과 LAN 사이에서 데이터를 중개할 떄, 각 LAN에서 사용하는 MAC 계층이 다를 수 있다.
* 예를 들어, 그림에서 LAN1은 이더넷, LAN2는 토큰링을 사용한다고 가정할 수 있다.
* 이때는 브리지에 MAC 헤더를 해석해 변환하는 기능이 필요하다.
* 즉, LAN1로부터 데이터를 수신할 때는 해당 MAC 계층 헤더를 해석하고 제거해야 한다.
* 그러면 그림처럼 브리지의 최상위 계층에서는 MAC 헤더가 제거되고, LLC 헤더까지 포함된 데이터만 남는다.
* 반대로 LAN2로 전송할 때는 해당 LAN의 MAC 계층에 맞도록 헤더 정보를 적절히 추가해야 한다.
</br>

* 위 예는 브리지에 연결된 LAN이 두 개인 경우지만, 브리지는 더 많은 LAN을 동시에 연결할 수 있다.
* 따라서 브리지에 연결된 LAN의 종류만큼 MAC 계층과 물리 계층을 해석할 수 있어야 한다.
* 동작 방식에 따라 트랜스페런트 브리지와 소스 라우팅 브리지가 있다.
</br>

### 1.1 트랜스페런트 브리지
* 트랜스페런트 브리지(Transparent Bridge)는 이름처럼 라우팅 기능을 사용자에게 투명하게 보여준다.
* 브리질 사용자는 전송하는 프레임의 주소부에 라우팅에 관한 정보를 추가하지 않아도 되며, 필요한 라우팅 과정은 브리지가 자동으로 수행한다.
* 설치 과정에서 하드웨어의 조정이나 소프트웨어의 변경, 주소, 라우팅 테이블 관련 사항을 고려할 필요가 없다.
</br>

* 브리지에 연결된 임의의 LAN으로부터 프레임이 도착했을 때, 브리지가 수행하는 동작은 다음 두 가지 중 하나이다.
* 첫째, 해당 프레임의 수신 호스트가 송신 호스트와 동일한 방향에 위치한 경우는 프레임을 중개하는 과정이 필요 없기 때문에 무시해도 된다.
* 둘째, 프레임의 수신 호스트가 송신 호스트와 다른 방향에 위치하는 경우는 수신 호스트가 있는 방향으로 프레임을 중개해야 한다.
* 이 과정에서 브리지 내부에는 송수신 호스트가 동일한 방향에 있는지와 수신 호스트가 브리지의 어느 방향에 위치하는지에 대한 정보가 있어야 한다. -> 라우팅 테이블
</br>
 
그림은 브리지 B1 과 브리지 B2 를 사용하는 환경에서 브리지 B1 에는 LAN을 세 개(LAN1, LAN2, LAN3) 연결하고, 브리지 B2 에는 LAN을 두 개(LAN3, LAN4) 연결한 예이다.     

![image](https://user-images.githubusercontent.com/83942393/128694051-342ba126-fa3e-450b-9c3b-72a8891b5783.png)
* LAN1에서 전송한 프레임의 목적지 호스트가 LAN1에 위치하면 브리지 B1 의 중개 기능이 필요없다.
* 그러나 LAN2에 위치한 호스트가 목적지라면 2번 포트로 중개해야 한다.
* 그리고 LAN4로 가는 경우에는 브리지 B2의 중개가 추가로 필요하다.
* 이때 브리지의 중개 기능이 올바르게 동작하려면, 그림 상단의 라우팅 테이블과 같은 라우팅 정보가 꼭 필요하다.
* 수신한 프레임을 무시할지, 다른 LAN으로 전달할지는 전적으로 브리지의 라우팅 테이블을 근거로 판단한다.
</br>

> 라우팅 테이블
* 트랜스페런트 브리지가 제대로 동작하려면 라우팅 테이블(Routing Table) 정보가 정확해야 한다.
* 라우팅 테이블은 LAN이 동작하면서 자동으로 생성되는데, 이 과정을 요약하면 다음과 같다.
</br>

* 먼저 브리지에 전원이 들어오면, 라우팅 테이블의 내용이 비어, 초기에는 프레임의 수신자가 어느 쪽 포트에 위치하는지 판단할 수 없다.
* 그러므로, 이 경우에는 **플러딩**(Flooding) 알고리즘을 사용해 입력된 프레임을 브리지의 모든 포트 방향으로 전달한다. *(물론, 프레임이 들어온 방향으로는 전달하지 않는다.)*
* 플러팅 알고리즘의 동작 과정에서 브리지에 입력된 송신 호스트의 주소를 근거로, 송신 호스트가 몇 번 포트에 연결되었는지 알 수 있다.
```
예를 들어, 그림의 브리지 B1의 경우에 2번 포트로 받은 프레임의 송신 호스트 주소가 c 이면, 호스트 c 는 2번 포트에 연결되어 있다고 판단할 수 있다.
```
* 이와 같이 데이터 전달 과정에서 얻은 프레임의 송신 호스트 주소와 포트 번호를 라우팅 테이블에 반영한다.
</br>

* 위 방법을 사용하면 시간이 경과함에 따라 라우팅 테이블의 정보가 계속 누적되므로 라우팅 정보를 효과적으로 수집할 수 있다.
* 또, 호스트의 연결 위치를 변경해도 라우팅 정보를 자동으로 갱신할 수 있다.
* 이처럼 네트워크의 동작 과정에서 라우팅 정보를 얻는 방식을 **역방향 학습** (Backward Learning) 알고리즘이라 한다.
</br>

* 호스트의 위치가 바뀌어 라우팅 정보가 변경되는 경우에는, 가장 최근 정보로 수정해주어야 한다.
* 그림에서 LAN2에 연결된 호스트 c 가 LAN4로 이동하면 수신된 프레임의 송신 호스트 정보를 근거로 라우팅 테이블의 내용을 새로 수정해야 한다.
* 브리지 B1과 브리지 B2의 라우팅 테이블에 호스트 c 의 이동을 반영하면 다음 그림과 같다.
</br>

<img src="https://user-images.githubusercontent.com/83942393/128695060-2d30cc1b-53c7-4ae2-93a9-a3fa66845591.png" width="60%" height="60%"></img></br>
</br>

> 스패닝 트리




