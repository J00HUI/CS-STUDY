### 🔆 Preview
전송 매체에는 트위스티드 페어(Twisted Pair), 동축케이블, 광케이블 등의 유선 매체와 적외선, 레이저, 마이크로파, 라이도 등의 무선 매체가 있다.
전화망은 아날로그 방식을 이용하는 음성 데이터 전송망으로, 통신 시스템 중 가장 먼저 개발되고 현재도 폭넓게 사용하고 있다.
디지털 방식의 컴퓨터가 전화망에 연결해 통신하려면 전화망과 컴퓨터 단말기 사이에 모뎀이 필요하다.

무선 휴대 통신 기기와 인터넷이 폭넓게 보급되면서 디지털 통신 환경이 보편화되고 있다.
디지털 통신 방식은 아날로그 방식보다 오류율은 낮고 전송률은 높다.
또 음성, 영상, 컴퓨터 데이터 등 멀티미디어 데이터 처리에 효과적이다.

네트워크 표준 모델은 **LAN 환경에 한하여** 특별히 계층 2의 역할을 LLC와 MAC 계층으로 구분하여 설명한다.
이와 같은 구분을 이해하려면, WAN과 LAN 환경에서 계층 2의 역할에 어떤 차이가 있는지 알아야 한다.
한편, LAN의 네트워크 연결 구조가 바뀜에 따라 MAC 계층 역시 다양한 구조를 필요로 한다.
따라서 주요 MAC 프로토콜의 구조를 이해함으로써 WAN과 LAN 환경의 차이와 네트워크 동작 원리를 이해할 수 있다.

5장에서는 OSI 7계층 모델의 계층 2에 해당하는 데이터 링크 계층에 대하여 설명한다.
LAN 환경에서 데이터 링크 계층은 LLC 계층과 MAC 계층으로 역할이 구분된다.
또한 LAN 의 종류에 따라 MAC 계층도 여러 종류가 존재한다.
따라서 이러한 다양한 프로토콜이 표준안에서 서로 어떤 연관을 갖는지 이해할 필요가 있다.
마지막으로 LAN 환경에서 사용하는 주요 MAC 프로토콜인 이더넷, 토큰 벗, 토큰 링의 구조와 동작 원리에 대하여 상세하게 설명한다.    
</br>

### 💎 01 MAC 계층과 IEEE 802 시리즈

원거리에 있는 호스트를 연결하는 WAN 과 달리 LAN 환경은 근거리에 분포된 호스트를 연결한다.   
따라서 LAN 환경에서는 WAN 환경에서보다 효율적인 전송 관리를 통해 네트워크의 이용 효율을 극대화해야 한다.   
네트워크 전송 효율은 주로 전송 매체의 성능에 좌우되지만, 연결 방식이나 전송 방법에도 영향을 많이 받는다.   
이 절에서는 LAN 환경의 계층 2 기능에 대한 표준안을 다루는 IEEE 802 시리즈를 알아본다.   
IEEE 802 시리즈는 LLC 계층뿐 아니라 MAC 계층에 대한 다양한 표준안을 정의하고 있다.   
</br>

### 1. MAC 계층의 이해
LAN 환경에서는 네트워크 자원을 효율적으로 활용하려고 그림 (a)와 같이 데이터 링크 계층의 기능을 LLC 계층과 MAC 계층으로 나누어 처리한다.    
즉, OSI 7계층 모델에서 정의한 데이터 링크 계층의 기본 기능은 주로 LLC 계층에서 다루고, 물리적인 전송 선로의 특징과 특정 매체 간의 연결 방식에 따른 제어 부분은 MAC 계층에서 처리한다.   
(b)의 WAN 환경과 비교해 보면, LAN의 LLC 계층이 WAN 의 데이터 링크 계층과 역할이 비슷하기 때문에, LAN 환경에 MAC 계층이 추가된 것으로 볼 수 있다.   

<img src="https://user-images.githubusercontent.com/83942393/129463562-581cc45c-dc41-442a-993e-354e9ad38786.png" width="60%" height="60%"></img></br>
</br>

### 1.1 MAC 계층
* MAC(Medium Access Control) 계층은 전송 선로의 물리적인 특성을 반영하므로, LAN의 종류에 따라 특성이 구분된다.
* LAN 환경을 위한 MAC 계층은 종류가 다양한데, 공유 버스 방식을 지원하는 이더넷과 링 구조 방식을 지원하는 토큰 링 방식이 대표적인 예이다.
* 컴퓨터 네트워크에서 가장 많이 사용하는 이더넷(Ethernet)은 공유 버스를 이용해 호스트를 연결한다.
* 이더넷에서는 데이터를 전송하기 전에, 전송 선로를 먼저 확인해 다른 호스트가 데이터를 전송 중인지 여부를 파악해야 한다.
* 다른 호스트가 선로를 사용하지 않으면, 데이터 프레임을 전송할 수 있지만, 사용하고 있다면 정해진 정책에 따라 나중에 다시 시도해야 한다.
* 둘 이상의 호스트에서 동시에 데이터 프레임 전송을 시도하면, 충돌(Collision)이 발생한다.
* 충돌이 생기면 호스트는 이를 감지하고, 일정 시점이 지난 후에 재전송해야 한다. (사후 예방 방법)
* 토큰 링(Token Ring) 방식에서는 토큰(Token)이라는 특정 패턴의 제어 데이터가 링을 순환한다.
* 데이터 프레임을 전송하려면, 먼저 토큰을 확보해야 하며, 전송을 완료하자마자 토큰을 링에 내놓아야 한다. (사전 예방 방법)
* 토큰 링 방식에서는 각 호스트에 전송 우선순위(Priority)를 부여할 수 있다.
</br>

### 1.2 LLC 계층
* LAN 환경에서 LLC(Logical Link Control) 계층은 WAN 환경의 데이터 링크 계층과 기능이 거의 유사하다.
* 그러나 LAN 종류에 따라 MAC 계층의 설계 형태가 영향을 받는 것처럼, LLC 계층도 LAN의 특성에 부분적으로 영향을 받을 수 있다.
* 그러므로 이더넷에서 사용하는 LLC와 토큰 링에서 사용하는 LLC는 약간 다를 수 있다.
```
예를 들어, 이더넷의 LLC 계층은 프레임을 전송하는 과정에서 슬라이딩 윈도우 프로토콜을 사용한다.
반면, 토큰 링이나 토큰 버스 구조에서는 송신 호스트가 수신 호스트의 도움 없이, 보낸 프레임의 전송 오류를 검출하고 재전송하는 기능을 수행할 수 있어 슬라이딩 윈도우 프로토콜이 불필요하다.
```
</br>

### 2. IEEE 802 시리즈
국제 표준화 단체인 IEEE 에서 데이터 링크 계층과 관련된 다양한 LAN 표준안 연구 결과를 IEEE 802 시리즈로 발표하였다.   

* IEEE 802.1 : 관련 표준안 전체를 소개, 인터페이스 피리미티브에 대한 정의
* IEEE 802.2 : 데이터 링크 계층의 상위 부분인 LLC 프로토콜의 정의
* IEEE 802.3 : 물리 계층과 MAC 계층에 대한 내용
  * IEEE 802.3 : 이더넷으로 알려진 CSMA/CD 방식
  * IEEE 802.4 : 토큰 버스 방식
  * IEEE 802.5 : 토큰 링 방식   

에 관한 내용을 규정한다.   

그림은 계층 구조 모델에서 LLC 계층과 MAC 계층의 관계를 설명하며, IEEE 표준안에서 정의된 계층의 역할을 보여준다.   

<img src="https://user-images.githubusercontent.com/83942393/129463850-2db3933e-0364-4b9f-8a9f-eaac18555d30.png" width="60%" height="60%"></img></br>
</br>

네트워크 계층과 LLC 계층의 기능은 LAN 종류에 큰 영향을 받지 않으므로, 공통의 프로토콜인 IEEE 802.2 표준안을 사용한다.   
그러나, MAC 계층은 물리 계층의 종류에 따라서 다양하게 사용될 수 있으므로, 각각에 대하여 별도의 표준안이 정의되어 있다.  
</br>

### 2.1 CSMA/CD
* 다중 접근 채널(Multiple Access Channel) 방식을 이용하여 공유 매체에 프레임을 전송하는 방식에서는 데이터 충돌 가능성이 항상 존재한다.
```
충돌 문제를 해결하는 방법은 크게 두 가지이다.

하나는 다수의 호스트가 송신한 프레임이 공유 매체에서 충돌하는 현상을 허용하는 방식으로, 충돌이 발생한 후에 문제를 해결한다.
다른 하나는 충돌이 발생할 가능성을 원천적으로 차단하는 방식이다. - 충돌 회피
```
* 충돌을 허용하는 방식의 대표적인 예는 이더넷으로 더 많이 알려진 CSMA/CD (Carrier Sense Multiple Access/Collision Detection) 이다.
* 충돌 허용 방식에서는 충돌로 깨진 프레임을 복구하는 작업(재전송)이 필요하기 때문에, 프레임을 송신한 호스트에서 충돌을 감지하는 기능이 반드시 필요하다.
* CSMA/CD 방식에서 충돌이 자주 발생하면, 오류 복구 과정에 따라 재전송도 많이 이루어진다.
* 따라서, 동일한 프레임을 여러 번 재전송하는 과정을 반복하므로, 네트워크의 전체 성능이 떨어진다.
* 일반적으로 공유 매체의 길이가 길수록, 전송 지연이 증가하여 충돌이 발생할 가능성도 높아진다.
</br>

```
충돌 회피 방식은 종류가 다양하다.
가장 간단한 방법은, 각 송신 호스트에 서로 다른 전송 시간대를 지정하는 타임슬롯(Time Slot)을 배정하는 방법이다.
```
</br>

전송 프레임은 버스 구조에 연결된 모든 호스트에 전송되기 때문에 (b)와 같이 프레임의 목적지가 아닌 호스트 2, 3, 4에도 도착한다.   
호스트 1을 제외한 나머지 호스트는 이 프레임을 수신할 이유가 없으므로 버려야 한다.   
이 기능을 지원하려고, 각 호스트에는 고유 주소가 할당되고, 전송 프레임에는 (a)와 같이 목적지 주소를 호스트 1로 지정한 후, 프레임을 전송해야 한다.   
결과적으로 그림 (c)와 같이 호스트 5에서 호스트 1까지 프레임을 올바르게 전송할 수 있다.   

<img src="https://user-images.githubusercontent.com/83942393/129464149-ff86e830-8db5-4b80-8742-f79f85a11673.png" width="60%" height="60%"></img></br>
</br>

### 2.2 토큰 버스
토큰 버스(Token Bus) 방식은 그림과 같이 물리적인 버스 구조(점선)로 연결되지만, 논리적인 프레임 전달은 링 구조(실선)이다.   

* 이 방식은 프레임을 전송하기 전에 버스 신호를 감지하는 CSMA/CD 방식과 다른 형태의 전송 메커니즘을 사용한다.   
* 즉, 데이터 프레임 전송이 호스트 사이에 순차적으로 이루어지도록 토큰(Token)이라는 제어 프레임을 사용한다.   
</br>

<img src="https://user-images.githubusercontent.com/83942393/129464244-8c724074-59d8-48cd-a83e-f7ba3fad7dfb.png" width="60%" height="60%"></img></br>

#### <토큰 방식>
* 프레임을 전송하려면 반드시 토큰을 확보해야 한다.
* 프레임 전송을 원하는 호스트는 토큰이 도착할 때까지 기다려서 도착한 토큰을 획득한 뒤 프레임을 전송한다.
* 프레임 전송을 완료하면 이웃 호스트에 토큰을 넘겨준다
* 호스트가 이웃하는 순서는, 물리적인 수서가 아니라 각 호스트의 고유 번호와 관련이 있다.
* 높은 번호부터 네트워크에 연결되고, 토큰 전달도 먼저 이루어진다.
</br>

### 2.3 토큰 링
그림과 같은 순환 구조의 전송 매체와 연결되는 링 인터페이스의 동작은 대기 모드와 전송 모드로 구분된다.   
</br>

> 대기 모드 : 입력단으로 들어온 비트를 출력단으로 즉시 내보낸다.

따라서, 호스트가 다운되거나 기타 장애가 발생하면 대기 모드가 되어 네트워크의 동작에 영향을 주지 않는다.   
대기 모드에서 호스트는 링 네트워크를 유지하는 역할만 수행한다.   

<img src="https://user-images.githubusercontent.com/83942393/129464364-61531530-937e-4290-bfca-2c75bb7f0e4c.png" width="40%" height="40%"></img> <img src="https://user-images.githubusercontent.com/83942393/129464352-902321c7-a4bb-4533-aecb-d39cf6548b7c.png" width="50%" height="50%"></img></br>
</br>

> 전송 모드 : 호스트가 토큰을 획득해 프레임을 전송할 수 있는 권한을 보유한 상태이다.

이때는 네트워크의 입력단과 출력단의 논리적인 연결이 끊어지는 대신, 네트워크가 호스트의 중개를 거쳐서 연결된다.   
호스트는 전송하고자 하는 프레임을 출력단을 통해 링으로 보낼 수 있다.   
</br>

**토큰 링** (Token Ring)
* 송신 호스트가 전송한 프레임이 링을 한 바퀴 돈 후 송신 호스트에 되돌아오도록 설계된다.
* 이 과정에서 프레임의 목적지 주소가 자신의 주소와 동일한 호스트는 해당 프레임을 수신하고, 프레임 내부의 특정 위치에 올바르게 수신했다고 표시한다.
* 송신 호스트는 자신에게 되돌아온 프레임의 특정 위치 값을 확인하여, 프레임이 올바로 전송되었음을 확인한 뒤, 데이터 프레임을 회수하고 토큰 프레임을 링에 회수한다.
</br>

### 💎 02 이더넷
* IEEE 802.3 은 1-persistent CSMA/CD 방식의 LAN 환경에 관해 규정한 표준안이며, 공유 버스로 연결한 호스트 간의 데이터 전송에 관한 사항을 다룬다.
* 이더넷은 원래 IEEE 802.3 표준안을 실제로 구현한 제품이지만, 현재는 더 일반화된 용어로 사용한다.
</br>

### 1. 이더넷과 신호 감지 기능
* 공유 버스 구조에서 호스트 간의 프레임 충돌을 방지하려면, 프레임을 전송하기 전에 다른 호스트가 공유 버스를 사용하고 있는지 확인해야 한다.
* 이는 전송 선로에 흐르는 전기 신호를 감지하는 기능으로 구현할 수 있다. 
* 전송 매체의 신호를 감지해, 프레임의 전송 여부를 결정하는 프로토콜을 신호 감지(Carrier Sense) 프로토콜이라 한다.
* 신호 감지 프로토콜에서는 선로의 전달 지연이 성능에 영향을 많이 준다.
* 다음은 신호 감지 프로토콜의 종류이다.
</br>

#### CSMA에서 매체가 빈(free) 직후 어떤 행동양식들을 취할까?

### 1.1 1-persistent CSMA
* 신호 감지 프로토콜 중에서 가장 간단한 형태는 1-persistent CSMA 방식이다.
* 이 방식은 일반 신호 감지 프로토콜처럼 프레임을 전송하기 전에 전송 채널이 사용 중인지 확인한다.
* 다른 호스트에서 채널을 사용 중이라고 판단하면, 유휴 상태가 될 때까지 대기한다.
* 그러다가 임의의 순간에 채널이 유휴 상태로 변경되면, 확률 1의 조건으로 프레임을 무조건 전송하기 때문에 1-persistent CSMA 라 한다.
* 둘 이상의 호스트에서 동시에 전송 채널의 유휴 상태를 기다렸다가, 유휴 상태로 판단하면 프레임 전송 과정에서 충돌이 발생할 수 있다.
* 충돌이 발생하면, 임의의 시간 동안 대기한 후에 채널을 감지하는 과정을 다시 반복한다.
```
* 낙천형
* 충돌되지 않으리라는 확률 1 을 갖고 사용중이지 않은 것을 감지하자마자 즉시 매체 접근하여 데이터 프레임 송출
* 충돌 발생 가능성이 가장 크므로, 채널 사용률이 낮은 대신에, 대기시간은 짧음
* 유선 LAN 이더넷에서는 이렇게 행동함
```
</br>

### 1.2 Non-persistent CSMA
* Non-persistent CSMA 방식에서는 전송 채널의 신호를 감지해, 채널이 사용 중이라고 판단하면 더는 채널의 유휴 상태를 확인하지 않는다.
* 대신 임의의 시간 동안 기다린 후에 다시 채널 감지를 시작하기 때문에, 1-persistent 방식보다 충돌이 발생할 확률을 줄일 수 있다.
```
1-persistent CSMA 방식에서는 여러 호스트가 채널이 유휴 상태가 되기를 기다리다가 동시에 프레임을 전송할 수 있기 때문에, 
충돌이 발생할 가능성도 높다.
```
```
* 비관형
* 반드시 충돌될 것이라고 비관하여 비록 사용중이지 않은 것을 감지하여도, 확률분포에서 얻어진 임의의 시간 만큼 무조건 기다린 후 매체 접근
* 충동이 적어 채널 사용률은 좋아지나, 대기 시간이 길어짐
```
</br>

### 1.3 p-persistent CSMA
* p-persistent CSMA 방식은 슬롯 채널 방식에서 많이 사용한다.
* 채널이 유휴 상태이면 p 확률로 프레임을 전송하고(?), 채널이 사용 중이면 다음 슬롯을 기다린 후 앞의 과정을 반복한다.
```
* 의심 염려형
* 사용중이지 않은 것을 감지하면,
* 전체중 확률 p 가 충돌되지 않을 것으로 판단하여, 매체 접근하고, 
* 의심을 갖는 나머지 확률 (1-p)는 한 단위시간 만큼(다음 slot) 기다린 후, 매체에 접근
* nonpersistent 처럼 충돌은 줄이고, 1-persistent 처럼 대기 시간을 줄이고자 하는 위 두 가지에 대한 타협안임.
```
</br>

### 1.4 CSMA/CD








































